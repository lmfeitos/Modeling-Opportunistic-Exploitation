
### Gather Data
# source("Read in Data.R")

#########################################################################
#########################################################################
#########################################################################
#########################################################################
### PLOTTING ONE =====
pdf("Scenarios plotting_v5.pdf", height = 6, width = 8)
numrow<- 1
numcol<- 2
tracker<- 0
par(mfrow = c(numrow, numcol))
par(pch = 16, cex.lab = 1.2, cex.axis = 1, yaxs = "i", mar = c(3.5,.5,4,1), oma = c(1, 5, 1, 0))

# this plots the base case -- species 1 is  the only one plotted since there is 'no species 2'
plot(x = Base_plottingsp1[,1], y = Base_plottingsp1[,2], col = "black",
     #ylim = c(min(plotthis[,c(2,3)])-.05, max(plotthis[,c(2,3)])+.1),
     ylim = c(0,1),
     xaxt = "n", yaxt = "n", ann = FALSE,
     # xlab = "Price ratio", ylab = "Final/Initial population size",
     cex = 1)
lines(x = Base_plottingsp1[,1], y = Base_plottingsp1[,3], col = "black")
lines(x = Base_plottingsp1[,1], y = Base_plottingsp1[,4], col = "black")

box(col = "gray29")
axis(side = 1, seq(from = 0, to = 250, by = 50), col.ticks = "gray29", col.axis = "gray29" )
#mtext("Revenue ratio", side = 1, line = 2.5, cex = 1.2, col = "gray20")
mtext("Year", side = 1, line = 2.5, cex = 1.2, col = "gray20")
if(tracker%%numcol == 0){
  axis(at = c(0, .2,.4, .6, .8, 1), side = 2, col.ticks = "gray29", col.axis = "gray29" )
  mtext("Final / Initial Population Size", side = 2, line = 2.5, cex = 1.2, col = "gray20")
}
axis(at = c(0, .2,.4, .6, .8, 1), side = 2, col.ticks = "gray29", col.axis = "gray29", labels = FALSE)


## OE SPECIES 2
points(x= OE_plottingsp2[,1], y = OE_plottingsp2[,2], col = adjustcolor("gray69", alpha.f = 0.5), cex = 1)
lines(x = OE_plottingsp2[,1], y = OE_plottingsp2[,3], col = adjustcolor("gray69", alpha.f = 0.5), cex = 1)
lines(x = OE_plottingsp2[,1], y = OE_plottingsp2[,4], col = adjustcolor("gray69", alpha.f = 0.5), cex = 1)

# this plots the anthropogenic allee case
points(x= Anth_plottingsp1[,1], y = Anth_plottingsp1[,2], col = "dodgerblue3", cex = 1)
lines(x = Anth_plottingsp1[,1], y = Anth_plottingsp1[,3], col = "dodgerblue3")
lines(x = Anth_plottingsp1[,1], y = Anth_plottingsp1[,4], col = "dodgerblue3")

#this plots the allee effect case

points(x= Allee_plottingsp1[,1], y = Allee_plottingsp1[,2], col = "firebrick3", cex = 1)
lines(x = Allee_plottingsp1[,1], y = Allee_plottingsp1[,3], col = "firebrick3")
lines(x = Allee_plottingsp1[,1], y = Allee_plottingsp1[,4], col = "firebrick3")

points(x= OE_plottingsp1[,1], y = OE_plottingsp1[,2], col = "orange", cex = 1)
lines(x = OE_plottingsp1[,1], y = OE_plottingsp1[,3], col = "orange")
lines(x = OE_plottingsp1[,1], y = OE_plottingsp1[,4], col = "orange")


# points(x = 0.26604082, y = .2013813, col = "gray20", cex = 1.5, pch = 1, lwd = 2) #.201
# points(x = 0.71457143, y = 0.1576667, col = "gray20", cex = 1.5, pch = 1, lwd = 2) #.157
# text("F/I =.201", x = .26, y = .19, pos = 1,  col = "gray20")
# text("F/I =.157", x = .71, y = .15, pos = 1,  col = "gray20")

mtext(paste("Extinction Scenarios"), side = 3, line = .6, cex = 1.3, col = "gray20")
#mtext("Revenue", side = 3, line = .8, cex = 1.5, col = "gray20")

legend(x= 305, y = 1, pch = 19, col = c("black", "firebrick3", "dodgerblue3", "orange", "gray69"),
       legend = c("Base Case", "Allee Effect", "Anthropogenic Allee Effect", "Opportunistic Exploitation High Value Species", "Opportunistic Exploitation Low Value Species"), xpd = NA, bty = 'n', pt.cex = 1.5, 
       cex = 1, text.col = "gray20")

#############################################################
### PLOTTING TWO=====
# tracker<- tracker + 1
# 
# plot(x = OE_plottingsp1[,1], y = OE_plottingsp1[,2], col = "orange",
#      #ylim = c(min(plotthis[,c(2,3)])-.05, max(plotthis[,c(2,3)])+.1),
#      ylim = c(0,1),
#      xaxt = "n", yaxt = "n", ann = FALSE,
#      # xlab = "Price ratio", ylab = "Final/Initial population size",
#      cex = 1.5)
# lines(x = OE_plottingsp1[,1], y = OE_plottingsp1[,3], col = "orange")
# lines(x = OE_plottingsp1[,1], y = OE_plottingsp1[,4], col = "orange")
# 
# box(col = "gray29")
# axis(side = 1, seq(from = 0, to = 250, by = 50), col.ticks = "gray29", col.axis = "gray29" )
# #mtext("Revenue ratio", side = 1, line = 2.5, cex = 1.2, col = "gray20")
# mtext("Year", side = 1, line = 2.5, cex = 1.2, col = "gray20")
# if(tracker%%numcol == 0){
#   axis(at = c(0, .2,.4, .6, .8, 1), side = 2, col.ticks = "gray29", col.axis = "gray29" )
#   mtext("Final / Initial Population Size", side = 2, line = 2.5, cex = 1.2, col = "gray20")
# }
# axis(at = c(0, .2,.4, .6, .8, 1), side = 2, col.ticks = "gray29", col.axis = "gray29", labels = FALSE)
# 
# points(x= OE_plottingsp2[,1], y = OE_plottingsp2[,2], col = "gray48", cex = 1.5)
# lines(x = OE_plottingsp2[,1], y = OE_plottingsp2[,3], col = "gray48")
# lines(x = OE_plottingsp2[,1], y = OE_plottingsp2[,4], col = "gray48")
# #abline(h = max(plotthis[,2]), lty = 2, lwd = 3)
# #abline(h = 0, lty = 2, lwd = 3)
# 
# # points(x = 0.26604082, y = .2013813, col = "gray20", cex = 1.5, pch = 1, lwd = 2) #.201
# # points(x = 0.71457143, y = 0.1576667, col = "gray20", cex = 1.5, pch = 1, lwd = 2) #.157
# # text("F/I =.201", x = .26, y = .19, pos = 1,  col = "gray20")
# # text("F/I =.157", x = .71, y = .15, pos = 1,  col = "gray20")
# 
# mtext(paste("Two species"), side = 3, line = .6, cex = 1.3, col = "gray20")
# #mtext("Revenue", side = 3, line = .8, cex = 1.5, col = "gray20")

dev.off()

# plot(y = yearlysizematrixsp1[304,], x = 1:ncol(yearlysizematrixsp1), type = 'l', ylim = c(0,1))
# lines(y = yearlysizematrixsp1onesp[304,], x = 1:ncol(yearlysizematrixsp1), col = "red")
# 
# plot(y = yearlysizematrixsp1[1,], x = 1:ncol(yearlysizematrixsp1), type = 'l', ylim = c(0,1))
# 
# pdf("allruns.pdf")
# plot(y = yearlysizematrixsp1[1,], x = 1:ncol(yearlysizematrixsp1), type = 'l', ylim = c(0,1), main = "two species")
# for (i in 2:500){
#   lines(y = yearlysizematrixsp1[i,], x = 1:ncol(yearlysizematrixsp1),  col = i)
# }
# 
# plot(y = yearlysizematrixsp1onesp[1,], x = 1:ncol(yearlysizematrixsp1onesp), type = 'l', ylim = c(0,1), main = "one species")
# for (i in 2:500){
#   lines(y = yearlysizematrixsp1onesp[i,], x = 1:ncol(yearlysizematrixsp1onesp),  col = i)
# }
# dev.off()

# pdf("histogram.pdf")
# diffplot<- yearlysizematrixsp1onesp[,ncol(yearlysizematrixsp1onesp)] - yearlysizematrixsp1[,ncol(yearlysizematrixsp1)]
# #hist(diffplot)
# hist(diffplot, main = "Difference in yr 300 f/i", xlab = "onesp yr 300 f/i - two sp yr 300 f/i")
# dev.off()
# 
# pdf("yearextinct.pdf")
# 
# hist(extinctionyronesp, xlab = "Year extinct", main = "One Species")
# 
# hist(extinctionyr, xlab = "Year extinct", main = "Two Species")
# 
# hist(extinctionyr[which(extinctionyr>0)], xlab = "Year extinct", main = "Two Species, zoomed")
# 
# dev.off()
# 
# #################### big difference -- 33  49 168 170 195 260 300 327 344 366 369 382 404 408 413 423 434 456 500
# 
# plot(y = yearlysizematrixsp1[413,], x = 1:ncol(yearlysizematrixsp1), type = 'l', ylim = c(0,1))
# lines(y = yearlysizematrixsp1onesp[413,], x = 1:ncol(yearlysizematrixsp1), col = "red")
# 
# ##################### strong negative correlation - 2  4  5 10 18 21 26 40 47 51 66 70 73 97
# diffplot[2]
# diffplot[10]
# diffplot[73]
# diffplot[97]
# 
# 
# plot(y = diffplot, x = Binssubset[,3], xlab = "habitat quality grid correlation", ylab = "difference between year 300 depletion")
# 
# length(which(Binssubset[,3]))