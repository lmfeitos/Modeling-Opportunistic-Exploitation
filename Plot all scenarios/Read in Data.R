
nsims<- 300
#############################################################################
### Read in Allee Data===============


# ## read in data - Allee Effect One Species ==================
yearlysizematrixsp1<- read.table("yearlysizematrixsp1onesp_allee_trevor4", header = F)
yearlysizematrixsp2<- read.table("yearlysizematrixsp2onesp_allee_trevor4", header = F)

originalsp1<- yearlysizematrixsp1[1:nsims,]
originalsp2<- yearlysizematrixsp2[1:nsims,]

yearlysizematrixsp1<- yearlysizematrixsp1[1:nsims,]
yearlysizematrixsp2<- yearlysizematrixsp2[1:nsims,]

## make this "depletion" -- divide by initial population number
yearlysizematrixsp1<- yearlysizematrixsp1/yearlysizematrixsp1[1,1]
yearlysizematrixsp2<- yearlysizematrixsp2/yearlysizematrixsp2[1,1]

# yearlysizematrixsp1<- originalsp1
# yearlysizematrixsp2<- originalsp2

## number of simulations
simnum<- nsims

## calculate yearly mean depletion
species1avgbyyr<- apply(yearlysizematrixsp1, 2, FUN = median)
species2avgbyyr<- apply(X = yearlysizematrixsp2, 2, FUN = median)

## calculate yearly sd
# sp1yrsd<- rep(NA, ncol(yearlysizematrixsp1))
# sp2yrsd<- rep(NA, ncol(yearlysizematrixsp2)) 
# 
# for(i in 1:length(sp1yrsd)){
#   sp1yrsd[i]<- sd(yearlysizematrixsp1[,i])
#   sp2yrsd[i]<- sd(yearlysizematrixsp1[,i])
# }

quantilesp1<- matrix(NA, nrow = ncol(yearlysizematrixsp1), ncol = 3) 
quantilesp2<- matrix(NA, nrow = ncol(yearlysizematrixsp2), ncol = 3) 

for(i in 1:nrow(quantilesp1)){
  quantilesp1[i, ]<- quantile(yearlysizematrixsp1[, i], c(.025,.5, .975))
  quantilesp2[i, ]<- quantile(yearlysizematrixsp2[, i], c(.025,.5, .975))
}

nrow(quantilesp1)

## create plotting matrix for sp1  -- includes CI calculations
plottingsp1<- matrix(NA, nrow = nrow(quantilesp1), ncol = 4) #col 1 is year, col 2 is mean, col 3 is lower ci, col 4 is upper ci, 
plottingsp1[,1]<- 0:((nrow(quantilesp1)) - 1) 
plottingsp1[,2]<- quantilesp1[,2] 
plottingsp1[,3]<- quantilesp1[,1]
plottingsp1[,4]<- quantilesp1[,3]

## create plotting matrix for sp2  -- includes CI calculations
plottingsp2<- matrix(NA, nrow = nrow(quantilesp2), ncol = 4) #col 1 is year, col 2 is mean, col 3 is lower ci, col 4 is upper ci, 
plottingsp2[,1]<- 0:(nrow(quantilesp2) - 1)
plottingsp2[,2]<- quantilesp2[,2]
plottingsp2[,3]<- quantilesp2[,1]
plottingsp2[,4]<- quantilesp2[,3]


Allee_plottingsp1<- plottingsp1
Allee_plottingsp2<- plottingsp2




#############################################################################
### Read in Anthropogenic Allee Data===============


# ## read in data - Allee Effect One Species ==================
yearlysizematrixsp1<- read.table("yearlysizematrixsp1_aa1species", header = F)
yearlysizematrixsp2<- read.table("yearlysizematrixsp2_aa1species", header = F)

originalsp1<- yearlysizematrixsp1[1:nsims,]
originalsp2<- yearlysizematrixsp2[1:nsims,]

yearlysizematrixsp1<- yearlysizematrixsp1[1:nsims,]
yearlysizematrixsp2<- yearlysizematrixsp2[1:nsims,]

## make this "depletion" -- divide by initial population number
yearlysizematrixsp1<- yearlysizematrixsp1/yearlysizematrixsp1[1,1]
yearlysizematrixsp2<- yearlysizematrixsp2/yearlysizematrixsp2[1,1]

# yearlysizematrixsp1<- originalsp1
# yearlysizematrixsp2<- originalsp2

## number of simulations
simnum<- nsims

## calculate yearly mean depletion
species1avgbyyr<- apply(yearlysizematrixsp1, 2, FUN = median)
species2avgbyyr<- apply(X = yearlysizematrixsp2, 2, FUN = median)

## calculate yearly sd
# sp1yrsd<- rep(NA, ncol(yearlysizematrixsp1))
# sp2yrsd<- rep(NA, ncol(yearlysizematrixsp2)) 
# 
# for(i in 1:length(sp1yrsd)){
#   sp1yrsd[i]<- sd(yearlysizematrixsp1[,i])
#   sp2yrsd[i]<- sd(yearlysizematrixsp1[,i])
# }

quantilesp1<- matrix(NA, nrow = ncol(yearlysizematrixsp1), ncol = 3) 
quantilesp2<- matrix(NA, nrow = ncol(yearlysizematrixsp2), ncol = 3) 

for(i in 1:nrow(quantilesp1)){
  quantilesp1[i, ]<- quantile(yearlysizematrixsp1[, i], c(.025,.5, .975))
  quantilesp2[i, ]<- quantile(yearlysizematrixsp2[, i], c(.025,.5, .975))
}

nrow(quantilesp1)

## create plotting matrix for sp1  -- includes CI calculations
plottingsp1<- matrix(NA, nrow = nrow(quantilesp1), ncol = 4) #col 1 is year, col 2 is mean, col 3 is lower ci, col 4 is upper ci, 
plottingsp1[,1]<- 0:((nrow(quantilesp1)) - 1) 
plottingsp1[,2]<- quantilesp1[,2] 
plottingsp1[,3]<- quantilesp1[,1]
plottingsp1[,4]<- quantilesp1[,3]

## create plotting matrix for sp2  -- includes CI calculations
plottingsp2<- matrix(NA, nrow = nrow(quantilesp2), ncol = 4) #col 1 is year, col 2 is mean, col 3 is lower ci, col 4 is upper ci, 
plottingsp2[,1]<- 0:(nrow(quantilesp2) - 1)
plottingsp2[,2]<- quantilesp2[,2]
plottingsp2[,3]<- quantilesp2[,1]
plottingsp2[,4]<- quantilesp2[,3]


Anth_plottingsp1<- plottingsp1
Anth_plottingsp2<- plottingsp2


#############################################################################
### Read in Base Case Data===============

# ## read in data - Allee Effect One Species ==================
yearlysizematrixsp1<- read.table("yearlysizematrixsp1onesp_par24", header = F)
yearlysizematrixsp2<- read.table("yearlysizematrixsp2onesp_par24", header = F)

originalsp1<- yearlysizematrixsp1[1:nsims,]
originalsp2<- yearlysizematrixsp2[1:nsims,]

yearlysizematrixsp1<- yearlysizematrixsp1[1:nsims,]
yearlysizematrixsp2<- yearlysizematrixsp2[1:nsims,]

## make this "depletion" -- divide by initial population number
yearlysizematrixsp1<- yearlysizematrixsp1/yearlysizematrixsp1[1,1]
yearlysizematrixsp2<- yearlysizematrixsp2/yearlysizematrixsp2[1,1]

# yearlysizematrixsp1<- originalsp1
# yearlysizematrixsp2<- originalsp2

## number of simulations
simnum<- nsims

## calculate yearly mean depletion
species1avgbyyr<- apply(yearlysizematrixsp1, 2, FUN = median)
species2avgbyyr<- apply(X = yearlysizematrixsp2, 2, FUN = median)

## calculate yearly sd
# sp1yrsd<- rep(NA, ncol(yearlysizematrixsp1))
# sp2yrsd<- rep(NA, ncol(yearlysizematrixsp2)) 
# 
# for(i in 1:length(sp1yrsd)){
#   sp1yrsd[i]<- sd(yearlysizematrixsp1[,i])
#   sp2yrsd[i]<- sd(yearlysizematrixsp1[,i])
# }

quantilesp1<- matrix(NA, nrow = ncol(yearlysizematrixsp1), ncol = 3) 
quantilesp2<- matrix(NA, nrow = ncol(yearlysizematrixsp2), ncol = 3) 

for(i in 1:nrow(quantilesp1)){
  quantilesp1[i, ]<- quantile(yearlysizematrixsp1[, i], c(.025,.5, .975))
  quantilesp2[i, ]<- quantile(yearlysizematrixsp2[, i], c(.025,.5, .975))
}

nrow(quantilesp1)

## create plotting matrix for sp1  -- includes CI calculations
plottingsp1<- matrix(NA, nrow = nrow(quantilesp1), ncol = 4) #col 1 is year, col 2 is mean, col 3 is lower ci, col 4 is upper ci, 
plottingsp1[,1]<- 0:((nrow(quantilesp1)) - 1) 
plottingsp1[,2]<- quantilesp1[,2] 
plottingsp1[,3]<- quantilesp1[,1]
plottingsp1[,4]<- quantilesp1[,3]

## create plotting matrix for sp2  -- includes CI calculations
plottingsp2<- matrix(NA, nrow = nrow(quantilesp2), ncol = 4) #col 1 is year, col 2 is mean, col 3 is lower ci, col 4 is upper ci, 
plottingsp2[,1]<- 0:(nrow(quantilesp2) - 1)
plottingsp2[,2]<- quantilesp2[,2]
plottingsp2[,3]<- quantilesp2[,1]
plottingsp2[,4]<- quantilesp2[,3]


Base_plottingsp1<- plottingsp1
Base_plottingsp2<- plottingsp2


#############################################################################
### Read in Opportunistic Exploitation Data===============

# ## read in data - Allee Effect One Species ==================
yearlysizematrixsp1<- read.table("yearlysizematrixsp1_par24", header = F)
yearlysizematrixsp2<- read.table("yearlysizematrixsp2_par24", header = F)

originalsp1<- yearlysizematrixsp1[1:nsims,]
originalsp2<- yearlysizematrixsp2[1:nsims,]

yearlysizematrixsp1<- yearlysizematrixsp1[1:nsims,]
yearlysizematrixsp2<- yearlysizematrixsp2[1:nsims,]

## make this "depletion" -- divide by initial population number
yearlysizematrixsp1<- yearlysizematrixsp1/yearlysizematrixsp1[1,1]
yearlysizematrixsp2<- yearlysizematrixsp2/yearlysizematrixsp2[1,1]

# yearlysizematrixsp1<- originalsp1
# yearlysizematrixsp2<- originalsp2

## number of simulations
simnum<- nsims

## calculate yearly mean depletion
species1avgbyyr<- apply(yearlysizematrixsp1, 2, FUN = median)
species2avgbyyr<- apply(X = yearlysizematrixsp2, 2, FUN = median)

## calculate yearly sd
# sp1yrsd<- rep(NA, ncol(yearlysizematrixsp1))
# sp2yrsd<- rep(NA, ncol(yearlysizematrixsp2)) 
# 
# for(i in 1:length(sp1yrsd)){
#   sp1yrsd[i]<- sd(yearlysizematrixsp1[,i])
#   sp2yrsd[i]<- sd(yearlysizematrixsp1[,i])
# }

quantilesp1<- matrix(NA, nrow = ncol(yearlysizematrixsp1), ncol = 3) 
quantilesp2<- matrix(NA, nrow = ncol(yearlysizematrixsp2), ncol = 3) 

for(i in 1:nrow(quantilesp1)){
  quantilesp1[i, ]<- quantile(yearlysizematrixsp1[, i], c(.025,.5, .975))
  quantilesp2[i, ]<- quantile(yearlysizematrixsp2[, i], c(.025,.5, .975))
}

nrow(quantilesp1)

## create plotting matrix for sp1  -- includes CI calculations
plottingsp1<- matrix(NA, nrow = nrow(quantilesp1), ncol = 4) #col 1 is year, col 2 is mean, col 3 is lower ci, col 4 is upper ci, 
plottingsp1[,1]<- 0:((nrow(quantilesp1)) - 1) 
plottingsp1[,2]<- quantilesp1[,2] 
plottingsp1[,3]<- quantilesp1[,1]
plottingsp1[,4]<- quantilesp1[,3]

## create plotting matrix for sp2  -- includes CI calculations
plottingsp2<- matrix(NA, nrow = nrow(quantilesp2), ncol = 4) #col 1 is year, col 2 is mean, col 3 is lower ci, col 4 is upper ci, 
plottingsp2[,1]<- 0:(nrow(quantilesp2) - 1)
plottingsp2[,2]<- quantilesp2[,2]
plottingsp2[,3]<- quantilesp2[,1]
plottingsp2[,4]<- quantilesp2[,3]


OE_plottingsp1<- plottingsp1
OE_plottingsp2<- plottingsp2