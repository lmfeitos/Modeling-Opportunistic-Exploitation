## Show influence of average distance of species 1 on final depletion

yearlysizematrixsp1[,301] #from plotting medians.r
yearlysizematrixsp1onesp[,301]

# grid cell distance

calcdist<- matrix(NA, ncol = 10, nrow= 10)

for(i in 1:10){
  for(j in 1:10){
    calcdist[i,j]<- distancefxn(start = c(0,0), target = c(i-.5, j-.5))  #note that they are starting in specified corner
  }
}


#################two species scenario
#species 1 "weighted grid cell"
simavgdist<- rep(NA, 500)

for(sim in 1:500){
  sp1yr1temp<-  simdist1[,,1,sim]
  simavgdist[sim]<- median(sp1yr1temp * calcdist)
}


#species 2 "weighted grid cell"
simavgdist2<- rep(NA, 500)

for(sim in 1:500){
  sp2yr1temp<-  simdist2[,,1,sim]
  simavgdist2[sim]<- median(sp2yr1temp * calcdist)
}


#species 1 -- avg distance of an individual
simavginddist<- rep(NA, 500)

for(sim in 1:500){
  tempvec<- vector()
  sp1yr1temp<-  simdist1[,,1,sim]
  
  for(i in 1:10){
    for(j in 1:10){
      tempvec<- c(tempvec, rep(calcdist[i,j], sp1yr1temp[i,j]))
    }
  }
  
  simavginddist[sim]<- median(tempvec)
  
}

## Species 2 -- avg distance of an individual
simavginddist2<- rep(NA, 500)

for(sim in 1:500){
  tempvec<- vector()
  sp2yr1temp<-  simdist2[,,1,sim]
  
  for(i in 1:10){
    for(j in 1:10){
      tempvec<- c(tempvec, rep(calcdist[i,j], sp2yr1temp[i,j]))
    }
  }
  
  simavginddist2[sim]<- median(tempvec)
  
}



## Plot average individual distance -- Species 1 Two species
pdf("Distance Figures/Ind Distance plot.pdf")
plot(y = yearlysizematrixsp1[,301], x=simavginddist, xlab = "Median individual distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xpd = NA, las = 1)
testcor.lm<- lm(yearlysizematrixsp1[,301]~simavginddist)
# tempsum<- summary(cor.lm)
# tempcoeff<- tempsum$coefficients
summary(testcor.lm)$r.squared
# 0.2297813
abline(testcor.lm, col =  "red", lwd = 2)
dev.off()




#plot!
pdf("Distance Figures/Distance plot.pdf")
plot(y = yearlysizematrixsp1[,301], x=simavgdist, xlab = "Median distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xlim = c(0, 65), ylim = c(0, .65), xpd = NA, las = 1)
cor.lm<- lm(yearlysizematrixsp1[,301]~simavgdist)
# tempsum<- summary(cor.lm)
# tempcoeff<- tempsum$coefficients
summary(cor.lm)$r.squared
# 0.2297813
abline(cor.lm, col =  "red", lwd = 2)
dev.off()



## 95% CI:
pdf("Distance Figures/Distance plot with 95CI.pdf")
summary(simavgdist)
newx<- seq(.7071, 60.5151, by = .05)

plot(y = yearlysizematrixsp1[,301], x=simavgdist, xlab = "Median distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xlim = c(0, 65), ylim = c(0, .65), xpd = NA, las = 1)
abline(cor.lm, col =  "red", lwd = 2)
conf_interval<- predict(cor.lm, newdata = data.frame(simavgdist = newx), interval = "confidence", level = .95)
lines(newx, conf_interval[,2], col = "red", lty = 2)
lines(newx, conf_interval[,3], col = "red", lty = 2)
dev.off()


## 95% Prediction interval:
pdf("Distance Figures/Distance plot with 95pred.pdf")
plot(y = yearlysizematrixsp1[,301], x=simavgdist, xlab = "Median distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xlim = c(0, 65), ylim = c(0, .65), xpd = NA, las = 1)
abline(cor.lm, col =  "blue", lwd = 2)


pred_interval<- predict(cor.lm, newdata = data.frame(simavgdist = newx), interval = "prediction", level = .95 )
lines(newx, pred_interval[,2], col = "blue", lty = 2)
lines(newx, pred_interval[,3], col = "blue", lty = 2)
dev.off()

## 95% prediction interval for individual distance:
pdf("Distance Figures/Ind Distance plot with 95pred.pdf")
plot(y = yearlysizematrixsp1[,301], x=simavginddist, xlab = "Median individual distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xpd = NA, las = 1)
testcor.lm<- lm(yearlysizematrixsp1[,301]~simavginddist)
abline(testcor.lm, col =  "blue", lwd = 2)


pred_interval<- predict(testcor.lm, newdata = data.frame(simavginddist = seq(from = 4.301, to = 12.104, by =.02)), 
                        interval = "prediction", level = .95 )
lines(seq(from = 4.301, to = 12.104, by =.02), pred_interval[,2], col = "blue", lty = 2)
lines(seq(from = 4.301, to = 12.104, by =.02), pred_interval[,3], col = "blue", lty = 2)
dev.off()


## Impact of nontarget distance

pdf("Distance Figures/Distance plot nontarget.pdf")
plot(y = yearlysizematrixsp1[,301], x=simavgdist2, xlab = "Median distance nontarget from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i",  xpd = NA, las = 1)
cor.lmnon<- lm(yearlysizematrixsp1[,301]~simavgdist2)
abline(cor.lmnon, col =  "blue", lwd = 2)

dev.off()



## Impact of nontarget individual distance

pdf("Distance Figures/Ind distance plot nontarget.pdf")
plot(y = yearlysizematrixsp1[,301], x=simavginddist2, xlab = "Median distance nontarget from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i",  xpd = NA, las = 1)
cor.lmnon<- lm(yearlysizematrixsp1[,301]~simavginddist2)
abline(cor.lmnon, col =  "blue", lwd = 2)

dev.off()



#checking

# plot(1:500, simavgdist)
# simavgdist[439]
# simavgdist[440]
# 
# Binssubset[439,]
# Binssubset[440,]
# 
# simdist1onesp[,,1,439]
# simdist1onesp[,,1,440]
# 



#####################################
###################################


#one species scenario

simavgdist<- rep(NA, 500)

for(sim in 1:500){
  sp1yr1temp<-  simdist1onesp[,,1,sim]
  simavgdist[sim]<- median(sp1yr1temp * calcdist)
}


#species 1 -- avg distance of an individual
simavginddist<- rep(NA, 500)

for(sim in 1:500){
  tempvec<- vector()
  sp1yr1temp<-  simdist1onesp[,,1,sim]
  
  for(i in 1:10){
    for(j in 1:10){
      tempvec<- c(tempvec, rep(calcdist[i,j], sp1yr1temp[i,j]))
    }
  }
  
  simavginddist[sim]<- median(tempvec)
  
}

#plot!
pdf("Distance Figures/Base distance plot.pdf")
plot(y = yearlysizematrixsp1onesp[,301], x=simavgdist, xlab = "Median distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xlim = c(0, 65), ylim = c(0, .8), xpd = NA, las = 1)
cor.lm1<- lm(yearlysizematrixsp1onesp[,301]~simavgdist)
# tempsum<- summary(cor.lm)
# tempcoeff<- tempsum$coefficients
summary(cor.lm1)$r.squared
# 0.2297813
abline(cor.lm1, col =  "red", lwd = 2)
dev.off()



## 95% CI:
pdf("Distance Figures/Base distance plot with 95CI.pdf")
summary(simavgdist)
newx<- seq(.7071, 60.5151, by = .05)

plot(y = yearlysizematrixsp1onesp[,301], x=simavgdist, xlab = "Median distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xlim = c(0, 65), ylim = c(0, .8), xpd = NA, las = 1)
abline(cor.lm1, col =  "red", lwd = 2)


conf_interval<- predict(cor.lm1, newdata = data.frame(simavgdist = newx), interval = "confidence", level = .95)
lines(newx, conf_interval[,2], col = "red", lty = 2)
lines(newx, conf_interval[,3], col = "red", lty = 2)
dev.off()


## 95% Prediction interval:
pdf("Distance Figures/Base distance plot with 95pred.pdf")

plot(y = yearlysizematrixsp1onesp[,301], x=simavgdist, xlab = "Median distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xlim = c(0, 65), ylim = c(0, .8), xpd = NA, las = 1)
abline(cor.lm1, col =  "blue", lwd = 2)

pred_interval<- predict(cor.lm1, newdata = data.frame(simavgdist = newx), interval = "prediction", level = .95 )
lines(newx, pred_interval[,2], col = "blue", lty = 2)
lines(newx, pred_interval[,3], col = "blue", lty = 2)
dev.off()


#plot avg individual dist
pdf("Distance Figures/Base ind distance plot.pdf")
plot(y = yearlysizematrixsp1onesp[,301], x=simavginddist, xlab = "Median distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xlim = c(0, 14), ylim = c(0, .8), xpd = NA, las = 1)
cor.lmind<- lm(yearlysizematrixsp1onesp[,301]~simavginddist)
# tempsum<- summary(cor.lm)
# tempcoeff<- tempsum$coefficients
summary(cor.lmind)$r.squared
# 0.2297813
abline(cor.lmind, col =  "red", lwd = 2)
dev.off()



#plot avg individual dist with 95 pred
pdf("Distance Figures/Base ind distance plot with 95pred_August3.pdf")
plot(y = yearlysizematrixsp1onesp[,301], x=simavginddist, xlab = "Median distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xlim = c(3.7, 12.7), ylim = c(0, .8), xpd = NA, 
     las = 1, pch = 21, col = "black", bg = rgb(red=0.2, green=0.2, blue=0.2, alpha=0.2))
abline(cor.lmind, col =  "black", lwd = 2.5)
summary(simavginddist)
newdat<-  seq(from = 4.201, to = 12.204, by =.01)
pred_interval<- predict(cor.lmind, newdata = data.frame(simavginddist = newdat), interval = "prediction", level = .95 )
lines(newdat, pred_interval[,2], col = "black", lty = 2, lwd = 1.5)
lines(newdat, pred_interval[,3], col = "black", lty = 2, lwd = 1.5)
dev.off()


