## Two axis grid

## Show influence of average distance of species 1 on final depletion

yearlysizematrixsp1[,301] #from plotting medians.r
yearlysizematrixsp1onesp[,301]

# grid cell distance

calcdist<- matrix(NA, ncol = 10, nrow= 10)

for(i in 1:10){
  for(j in 1:10){
    calcdist[i,j]<- distancefxn(start = c(0,0), target = c(i-.5, j-.5))  #note that they are starting in specified corner
  }
}

#species 1 -- avg distance of an individual
simavginddist<- rep(NA, 500)

for(sim in 1:500){
  tempvec<- vector()
  sp1yr1temp<-  simdist1[,,1,sim]
  
  for(i in 1:10){
    for(j in 1:10){
      tempvec<- c(tempvec, rep(calcdist[i,j], sp1yr1temp[i,j]))
    }
  }
  
  simavginddist[sim]<- median(tempvec)
  
}

## Species 2 -- avg distance of an individual
simavginddist2<- rep(NA, 500)

for(sim in 1:500){
  tempvec<- vector()
  sp2yr1temp<-  simdist2[,,1,sim]
  
  for(i in 1:10){
    for(j in 1:10){
      tempvec<- c(tempvec, rep(calcdist[i,j], sp2yr1temp[i,j]))
    }
  }
  
  simavginddist2[sim]<- median(tempvec)
  
}

pdf("July 1 two species distance.pdf")

ii <- cut(yearlysizematrixsp1[,301], breaks = seq(min(yearlysizematrixsp1[,301]), max(yearlysizematrixsp1[,301]), len = 50), 
          include.lowest = TRUE)
## Use bin indices, ii, to select color from vector of n-1 equally spaced colors
colors <- colorRampPalette(c("navyblue", "gray90"))(49)[ii]

plot(x = simavginddist, y = simavginddist2, pch = 16, col = colors, xlab = "Average distance species 1", ylab = "Average distance species 2")

dev.off()

cor.lmsp1<- lm(yearlysizematrixsp1[,301]~simavginddist)
cor.lmsp2<- lm(yearlysizematrixsp1[,301]~simavginddist2)


pdf("Distance Figures/Aug3 OE sp1 distance plot.pdf")
plot(y = yearlysizematrixsp1[,301], x=simavginddist, xlab = "Median distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xlim = c(3.7, 12.7), ylim = c(0, 1), xpd = NA, 
     las = 1, pch = 21, col = "black", bg = rgb(red=0.2, green=0.2, blue=0.2, alpha=0.2))
abline(cor.lmsp1, col =  "black", lwd = 2.5)
summary(simavginddist)
newdat<-  seq(from = 4.201, to = 12.204, by =.01)
pred_interval<- predict(cor.lmsp1, newdata = data.frame(simavginddist = newdat), interval = "prediction", level = .95 )
lines(newdat, pred_interval[,2], col = "black", lty = 2, lwd = 1.5)
lines(newdat, pred_interval[,3], col = "black", lty = 2, lwd = 1.5)
dev.off()

pdf("Distance Figures/Aug3 OE sp2 distance plot.pdf")
plot(y = yearlysizematrixsp1[,301], x=simavginddist2, xlab = "Median distance from entry", ylab = "Year 300 depletion",
     main = "Impact of distance on depletion",
     xaxs = "i", yaxs = "i", xlim = c(1.6, 12), ylim = c(0, 1), xpd = NA, 
     las = 1, pch = 21, col = "black", bg = rgb(red=0.2, green=0.2, blue=0.2, alpha=0.2))
abline(cor.lmsp2, col =  "black", lwd = 2.5)
summary(simavginddist2)
newdat<-  seq(from = min(simavginddist2), to = max(simavginddist2), by =.01)
pred_interval<- predict(cor.lmsp2, newdata = data.frame(simavginddist2 = newdat), interval = "prediction", level = .95 )
lines(newdat, pred_interval[,2], col = "black", lty = 2, lwd = 1.5)
lines(newdat, pred_interval[,3], col = "black", lty = 2, lwd = 1.5)
dev.off()