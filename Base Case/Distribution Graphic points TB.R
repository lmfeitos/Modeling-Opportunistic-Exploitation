### HAS CODE FOR FINAL VERION

# load("simdist1_par24_v3_rerun.rda")
# load("simdist2_par24_v3_rerun.rda")
# load("simdist1onesp_par24_v3.rda")
# load("simdist2onesp_par24_v3.rda")

## OLD: For publication: 413 (+), 97

## NEW: For publication: 344 (+(0.40)), 34(-(â€“0.26))

############======================================
gr<- 34

#two species scenario
sp1two<- simdist1[,,,gr]
sp2two<- simdist2[,,,gr]

#single species scenario
sp1one<-  simdist1onesp[,,,gr]
sp2one<- simdist2onesp[,,,gr]

cor(c(sp1two[,,1]), c(sp2two[,,1])) # -0.01355979

justsp1<- sp1one


#changed words to black in 2
#increase size
#add words to first?
pdf("distplotcombined_ecomodreview.pdf", width = 12, height = 8.8)
par(mfrow = c(5, 9), oma = c(20, 2.5, 2.5, 12), mar = c(0 , 0, 0 , 0))
# par(mfrow = c(6, 9), oma = c(3.5, 2.5, 2.5, 12), mar = c(0 , 0, 0 , 0))
whichyears<- c(1,2, 3, 6, 11, 26, 101, 201, 301)
yearlabels2<- c("Year 0", "Year 1", "Year 2", "Year 5", "Year 10", "Year 25", "Year 100", "Year 200", "Year 300")
yearlabels<- c("0", "1", "2", "5", "10", "25", "100", "200", "300")

#only one species

for(yr in 1:length(whichyears)){
  sp1<- justsp1[,,whichyears[yr]]
  plot(1,type="n",axes=F,ann=F, xlim=c(0,11),ylim=c(0,12), yaxs="i", xaxs="i") 
  box(col="black")
  #mtext(yearlabels[i], side = 1, line = 1)
  # for(i in 1:9){
  #   abline(h = i, col="gray66")
  #   abline(v = i, col="gray66")
  # }
  for(i in 1:10){ #collumns
    for(j in 1:10){ #rows
      y1<- rep(j - .5 + .5, sp1[j,i])
      x1<- rep(i - .5 + .5, sp1[j,i])
      points(x = jitter(x1, amount = .4), y = jitter(y1, amount = .4), col = "firebrick3", cex = .3, pch = 19)
      
      sumval<- sum(sp1)
      text(.5, 11.1, sumval, col = "firebrick3", cex = 1.2, font = 1, adj = 0)
      
      # sumval2<- sum(sp2)
      # text(9.5, 10.6, sumval2, col = "gray65", cex = 1.2, font = 1, adj = 1)
      # 
      # if(yr == length(whichyears)){
      #   sumval<- sum(sp1)
      #   #text(7.8, 9, paste("N =",sumval), col = "black",cex = 1.2, font = 1)
      #   text(7.7, 10.5, bquote(N[F] == .(sumval)), cex = 1.2)
      # }
      # if(yr == 1){
      #   sumval<- sum(sp1)
      #   #text(7, 9, expression(paste(N[0], "=", sumval)), col = "black", cex = 1.2, font = 1)
      #   text(7, 10.5, bquote(N[0] == .(sumval)), cex = 1.2)
      # }
      # 
      box(col="gray66")
    }
  }
}


#Both species, 1000
for(yr in 1:length(whichyears)){
  sp1<- sp1two[,,whichyears[yr]]
  sp2<- sp2two[,,whichyears[yr]]
  plot(1,type="n",axes=F,ann=F, xlim=c(0,11),ylim=c(0,12), yaxs="i", xaxs="i") 
  box(col="black")
  mtext(yearlabels2[yr], side = 1, line = .9, cex = .8, col = "gray25")
  #mtext(yearlabels[yr], side = 1, line = 1)
  # for(i in 1:9){
  #   abline(h = i, col="gray66")
  #   abline(v = i, col="gray66")
  # }
  for(i in 1:10){ #collumns
    for(j in 1:10){ #rows
      y1<- rep(j - .5 + .5, sp1[j,i])
      x1<- rep(i - .5 + .5, sp1[j,i])
      y2<- rep(j - .5 + .5, sp2[j,i])
      x2<- rep(i - .5 + .5, sp2[j,i])
      xx<- c(x1, x2)
      yy<- c(y1, y2)
      colplot<- c(rep("firebrick3", sp1[j,i]), rep("gray62", sp2[j,i]))
      
      thissamp<- sample(1:length(xx), length(xx), replace = FALSE)
      
      xx<- xx[thissamp]
      yy<- yy[thissamp]
      colplot<- colplot[thissamp]
      
      points(x = jitter(xx, amount = .4), y = jitter(yy, amount = .4), col = colplot, cex = .3, pch = 19)
      
      sumval<- sum(sp1)
      text(.5, 11.1, sumval, col = "firebrick3", cex = 1.2, font = 1, adj = 0)
      sumval2<- sum(sp2)
      text(10.1, 11.1, sumval2, col = "gray54", cex = 1.2, font = 1, adj = 1)
      
      # if(yr == length(whichyears)){
      #   sumval<- sum(sp1)
      #   #text(7.8, 9, paste("N =",sumval), col = "black",cex = 1.2, font = 1)
      #   text(7.8, 10.5, bquote(N[F] == .(sumval)), cex = 1.2)
      #   
      #   sumval2<- sum(sp2)
      #  # text(3, 5, paste(sumval2), cex = 1.5)
      # }
      # if(yr == 1){
      #   sumval<- sum(sp1)
      #   #text(7, 9, expression(paste(N[0], "=", sumval)), col = "black", cex = 1.2, font = 1)
      #   text(7, 10.5, bquote(N[0] == .(sumval)), cex = 1.2)
      # }
      # points(x = jitter(x2, amount = .4), y = jitter(y2, amount = .4), col = "gray", cex = .3, pch = 19)
      # points(x = jitter(x1, amount = .4), y = jitter(y1, amount = .4), col = "red3", cex = .3, pch = 19)
      # 
      
      box(col="gray66")
    }
  }
}


if(gr == 34){
  mtext("Negative spatial correlation (-0.36)", cex = 1.25, line = .7, side = 3, outer = TRUE)
}

if(gr == 344){
  mtext("Positive spatial correlation (0.21)", cex = 1.25, line = .7, side = 3, outer = TRUE)
}


legend(x = -21.2, y = 26.5, pch = 19, col = c("firebrick3", "gray62"),
       legend = c("Primary target species", "Secondary target species"), xpd = NA, bty = 'n', pt.cex = 1,
       cex = 1.1, ncol = 2)

#moves legend to the top... not a huge fan...
# legend(x = -1, y = 34.5, pch = 19, col = c("firebrick3", "gray65"),
#        legend = c("High value species", "Low value species"), xpd = NA, bty = 'n', pt.cex = 1, 
#        cex = 1.1)
mtext("Single Species", line = .2, side = 2, cex = .75, at = .29, outer = TRUE, col = "gray25")
# mtext("30% Revenue", line = .2, side = 2, cex = .8, at = .18, outer = TRUE, col = "gray25")
mtext("Two Species", line = .2, side = 2, cex = .75, at = .29-.18, outer = TRUE, col = "gray25")
# mtext("Year", line = -36.5, side = 1, cex = .95, outer = TRUE, col = "gray25")

for(yr in 1:length(whichyears)){
  plot.new()
}

############======================================
gr<- 344

#two species scenario
sp1two<- simdist1[,,,gr]
sp2two<- simdist2[,,,gr]

#single species scenario
sp1one<-  simdist1onesp[,,,gr]
sp2one<- simdist2onesp[,,,gr]

cor(c(sp1two[,,1]), c(sp2two[,,1]))

justsp1<- sp1one


#changed words to black in 2
#increase size
#add words to first?
# pdf("distplot_param23_sim97points_v2.pdf", width = 12, height = 4.4)
# par(mfrow = c(3, 9), oma = c(3.5, 2.5, 2.5, 12), mar = c(0 , 0, 0 , 0))
# whichyears<- c(1,2, 3, 6, 11, 26, 101, 201, 301)
# yearlabels<- c("Year 0", "Year 1", "Year 2", "Year 5", "Year 10", "Year 25", "Year 100", "Year 200", "Year 300")
# yearlabels2<- c("0", "1", "2", "5", "10", "25", "100", "200", "300")

#only one species

for(yr in 1:length(whichyears)){
  sp1<- justsp1[,,whichyears[yr]]
  plot(1,type="n",axes=F,ann=F, xlim=c(0,11),ylim=c(0,12), yaxs="i", xaxs="i") 
  box(col="black")
  #mtext(yearlabels[i], side = 1, line = 1)
  # for(i in 1:9){
  #   abline(h = i, col="gray66")
  #   abline(v = i, col="gray66")
  # }
  for(i in 1:10){ #collumns
    for(j in 1:10){ #rows
      y1<- rep(j - .5 + .5, sp1[j,i])
      x1<- rep(i - .5 + .5, sp1[j,i])
      points(x = jitter(x1, amount = .4), y = jitter(y1, amount = .4), col = "firebrick3", cex = .3, pch = 19)
      
      sumval<- sum(sp1)
      text(.5, 11.1, sumval, col = "firebrick3", cex = 1.2, font = 1, adj = 0)
      
      # sumval2<- sum(sp2)
      # text(9.5, 10.6, sumval2, col = "gray65", cex = 1.2, font = 1, adj = 1)
      # 
      # if(yr == length(whichyears)){
      #   sumval<- sum(sp1)
      #   #text(7.8, 9, paste("N =",sumval), col = "black",cex = 1.2, font = 1)
      #   text(7.7, 10.5, bquote(N[F] == .(sumval)), cex = 1.2)
      # }
      # if(yr == 1){
      #   sumval<- sum(sp1)
      #   #text(7, 9, expression(paste(N[0], "=", sumval)), col = "black", cex = 1.2, font = 1)
      #   text(7, 10.5, bquote(N[0] == .(sumval)), cex = 1.2)
      # }
      # 
      box(col="gray66")
    }
  }
}


#Both species, 1000
for(yr in 1:length(whichyears)){
  sp1<- sp1two[,,whichyears[yr]]
  sp2<- sp2two[,,whichyears[yr]]
  plot(1,type="n",axes=F,ann=F, xlim=c(0,11),ylim=c(0,12), yaxs="i", xaxs="i") 
  box(col="black")
  mtext(yearlabels2[yr], side = 1, line = .9, cex = .8, col = "gray25")
  #mtext(yearlabels[yr], side = 1, line = 1)
  # for(i in 1:9){
  #   abline(h = i, col="gray66")
  #   abline(v = i, col="gray66")
  # }
  for(i in 1:10){ #collumns
    for(j in 1:10){ #rows
      y1<- rep(j - .5 + .5, sp1[j,i])
      x1<- rep(i - .5 + .5, sp1[j,i])
      y2<- rep(j - .5 + .5, sp2[j,i])
      x2<- rep(i - .5 + .5, sp2[j,i])
      xx<- c(x1, x2)
      yy<- c(y1, y2)
      colplot<- c(rep("firebrick3", sp1[j,i]), rep("gray62", sp2[j,i]))
      
      thissamp<- sample(1:length(xx), length(xx), replace = FALSE)
      
      xx<- xx[thissamp]
      yy<- yy[thissamp]
      colplot<- colplot[thissamp]
      
      points(x = jitter(xx, amount = .4), y = jitter(yy, amount = .4), col = colplot, cex = .3, pch = 19)
      
      sumval<- sum(sp1)
      text(.5, 11.1, sumval, col = "firebrick3", cex = 1.2, font = 1, adj = 0)
      sumval2<- sum(sp2)
      text(10.1, 11.1, sumval2, col = "gray54", cex = 1.2, font = 1, adj = 1)
      
      # if(yr == length(whichyears)){
      #   sumval<- sum(sp1)
      #   #text(7.8, 9, paste("N =",sumval), col = "black",cex = 1.2, font = 1)
      #   text(7.8, 10.5, bquote(N[F] == .(sumval)), cex = 1.2)
      #   
      #   sumval2<- sum(sp2)
      #  # text(3, 5, paste(sumval2), cex = 1.5)
      # }
      # if(yr == 1){
      #   sumval<- sum(sp1)
      #   #text(7, 9, expression(paste(N[0], "=", sumval)), col = "black", cex = 1.2, font = 1)
      #   text(7, 10.5, bquote(N[0] == .(sumval)), cex = 1.2)
      # }
      # points(x = jitter(x2, amount = .4), y = jitter(y2, amount = .4), col = "gray", cex = .3, pch = 19)
      # points(x = jitter(x1, amount = .4), y = jitter(y1, amount = .4), col = "red3", cex = .3, pch = 19)
      # 
      
      box(col="gray66")
    }
  }
}


if(gr == 34){
  mtext("Negative spatial correlation (-0.36)", cex = 1.25, line = .7, side = 3, outer = TRUE)
}

if(gr == 344){
  mtext("Positive spatial correlation (0.21)", cex = 1.25, line = -25.3, side = 3, outer = TRUE)
}


# legend(x = -11.2, y = 26.5, pch = 19, col = c("firebrick3", "gray65"),
#        legend = c("High value species", "Low value species"), xpd = NA, bty = 'n', pt.cex = 1,
#        cex = 1.1, ncol = 2)

#moves legend to the top... not a huge fan...
# legend(x = -1, y = 34.5, pch = 19, col = c("firebrick3", "gray65"),
#        legend = c("High value species", "Low value species"), xpd = NA, bty = 'n', pt.cex = 1, 
#        cex = 1.1)
mtext("Single Species", line = .2, side = 2, cex = .75, at = .89, outer = TRUE, col = "gray25")
# mtext("30% Revenue", line = .2, side = 2, cex = .8, at = .18, outer = TRUE, col = "gray25")
mtext("Two Species", line = .2, side = 2, cex = .75, at = .89-.18, outer = TRUE, col = "gray25")
# mtext("Year", line = -6.5, side = 1, cex = .95, outer = TRUE, col = "gray25")



dev.off()
