###############
## Grid wide density dependence -- poisson process
## 11/2/2020

source("Anthropogenic Allee Effect Function.R")

# File where grids (500) are located:

help<- read.table("Subset of correlation grid seeds 100 each bin")
Binssubset<- help

source("Parameters File AA_1species.R")
### 
nsims<- 500
div<- 500/nsims


#################### ONE species ============
species2rev<- 0

# ## Process Error: 
# nratios<- 75
# processvec<- seq(from = .2, to = .4, length.out = nratios) #really the cv but didnt change var name


yearlysizematrixsp1<- matrix(NA, nrow = nsims, ncol = nstep+1)
yearlysizematrixsp2<- matrix(NA, nrow = nsims, ncol = nstep+1)

extinctionyr<- matrix(NA, nrow = 2, ncol = nsims)
#row 1 = species 1
#row 2 = species 2

for(sim in 1:nsims){
  sim<- div*sim
  temppoachers<- round(((nspecies1 * species1rev) + (nspecies2*species2rev))/poachval) #calculates number of poachers based on total revenue that is possible
  #set first seed
  set.seed(Binssubset[sim, 1])
  #generate omega grid
  Omega_grid1<- createomegagrid(Ngrid = numgrid, Nu = sample(x = seq(from = .0001, to = .8,
                                                                     length.out = 800),
                                                             size = 1))
  #set second seed
  set.seed(Binssubset[sim, 2])
  #generate omega grid
  Omega_grid2<-createomegagrid(Ngrid = numgrid, Nu = sample(x = seq(from = .0001, to = .8,
                                                                    length.out = 800),
                                                            size = 1))
  #reset seed
  set.seed(sim) #set seed back to a number unrelated to grid generation (this will be the same 500 seeds for all of the population ratios)
  
  temp<- multipletimesteps2species(Omega_gridsp1.fxn = Omega_grid1, 
                                   Omega_gridsp2.fxn = Omega_grid2,
                                   Nanimalssp1.fxn = nspecies1, Nanimalssp2.fxn = nspecies2,
                                   Ngrid.fxn = 10,
                                   numberpoachers.fxn = temppoachers, 
                                   nstep.fxn = nstep,
                                   rsp1.fxn = rsp1, rsp2.fxn = rsp2,
                                   variablec.fxn = varcost, fixedc.fxn = fixcost,
                                   # revenuesp1.fxn = 0,revenuesp2.fxn = 0,
                                   aasp1.fxn = aval1, aasp2.fxn = aval2, 
                                   bbsp1.fxn = bval1, bbsp2.fxn = bval2, 
                                   zsp1.fxn = zval1, zsp2.fxn = zval2,
                                   prob1successsp1.fxn = psucc1, 
                                   prob1successsp2.fxn = psucc2,
                                   sigmawsp1.fxn = 0, sigmawsp2.fxn = 0,
                                   sigmav.fxn = 0,
                                   selectivity.fxn = 1, 
                                   Probleave1.fxn = 0.05, 
                                   Probleave2.fxn = 0.05,
                                   ammocost.fxn = ammomoney, 
                                   carrybackcost.fxn = carrybackmoney)
  print(sim)
  yearlysizematrixsp1[sim/div,]<- temp[[7]]
  yearlysizematrixsp2[sim/div,]<- temp[[8]]
  extinctionyr[1, sim/div]<- temp[[11]]
  extinctionyr[2, sim/div]<- temp[[12]]
  
}

write.table(yearlysizematrixsp1, file = "yearlysizematrixsp1_aa1species", sep = " ",
            row.names = FALSE, col.names = FALSE)
write.table(yearlysizematrixsp2, file = "yearlysizematrixsp2_aa1species", sep = " ",
            row.names = FALSE, col.names = FALSE)
write.table(extinctionyr, file = "extinctionyr_aa1species", sep = " ",
            row.names = FALSE, col.names = FALSE)

